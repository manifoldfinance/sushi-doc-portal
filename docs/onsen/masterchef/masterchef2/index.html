<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="search" type="application/opensearchdescription+xml" title="Sushiswap Kitchen" href="/opensearch.xml"><title data-rh="true">MasterChefV2 | Sushiswap Kitchen</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://sushi.com/docs/onsen/masterchef/masterchef2"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="MasterChefV2 | Sushiswap Kitchen"><meta data-rh="true" name="description" content="Double Incentives"><meta data-rh="true" property="og:description" content="Double Incentives"><link data-rh="true" rel="icon" href="/img/favicon/favicon.ico"><link data-rh="true" rel="canonical" href="https://sushi.com/docs/onsen/masterchef/masterchef2"><link data-rh="true" rel="alternate" href="https://sushi.com/docs/onsen/masterchef/masterchef2" hreflang="en"><link data-rh="true" rel="alternate" href="https://sushi.com/docs/onsen/masterchef/masterchef2" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://XOPRM3IJU6-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.c224ef50.css">
<link rel="preload" href="/assets/js/runtime~main.540d009b.js" as="script">
<link rel="preload" href="/assets/js/main.30cfd76f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title">üç£ Sushi</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link">Guidebook</a><ul class="dropdown__menu"><li><a href="#" class="dropdown__link">Yield Farming and Strategies</a></li><li><a href="#" class="dropdown__link">Limit order protocol</a></li><li><a class="dropdown__link" href="/docs/onsen/masterchef/masterchef2">MasterChef v2</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link">Protocols</a><ul class="dropdown__menu"><li><a href="#" class="dropdown__link">Sushiswap</a></li><li><a class="dropdown__link" href="/docs/onsen/masterchef/introduction">MasterChef</a></li><li><a href="#" class="dropdown__link">Trident</a></li><li><a class="dropdown__link" href="/docs/bentobox/concepts">BentoVault</a></li><li><a href="#" class="dropdown__link">Miso Launchpad</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="#" class="navbar__item navbar__link">Incentive Programs</a><a href="#" class="navbar__item navbar__link">Deploy Strategy</a><a href="https://www.npmjs.com/search?q=%40sushiswap" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>@sushiswap/sdk<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/sushiswap" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Switch between dark and light mode (currently light mode)"></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/miso/Introduction">Miso</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/miso/Introduction">Miso</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/miso/deployments">Sushi Contracts</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/docs/onsen/">Onsen</a><button aria-label="Toggle the collapsible sidebar category &#x27;Onsen&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/onsen/IBentoBoxWithdraw">IBentoBoxWithdraw</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/onsen/IKashiWithdrawFee">IKashiWithdrawFee</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/onsen/IMigratorChef">IMigratorChef</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/onsen/MasterChef">MasterChef</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/onsen/MasterChefV2">MasterChefV2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/onsen/Migrator">Migrator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/onsen/MiniChefV2">MiniChefV2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/onsen/SushiBar">SushiBar</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/onsen/SushiMaker">SushiMaker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/onsen/SushiMakerKashi">SushiMakerKashi</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/onsen/SushiRoll">SushiRoll</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/onsen/SushiToken">SushiToken</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/onsen/interfaces/IERC20">interfaces</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/onsen/masterchef/Introduction">masterchef</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/onsen/masterchef/Introduction">MasterChef V2 - Sushi</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/onsen/masterchef/guide_doublerewards">Double Rewards: A Developer&#x27;s Guide - Dev Hub</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/onsen/masterchef/masterchef2">MasterChefV2</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item red"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/category/stratagies">Stratagies</a><button aria-label="Toggle the collapsible sidebar category &#x27;Stratagies&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/strategies/CompoundStrategy">CompoundStrategy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/strategies/IFactory">IFactory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/strategies/IPair">IPair</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/strategies/ISushiBar">ISushiBar</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/strategies/IcToken">IcToken</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/strategies/SushiStrategy">SushiStrategy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/strategies/">Sushi Strategies</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/bentobox/">Bentobox</a><button aria-label="Toggle the collapsible sidebar category &#x27;Bentobox&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bentobox/BentoBoxV1">BentoBoxV1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bentobox/IMasterChef">IMasterChef</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bentobox/MasterContractManager">MasterContractManager</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bentobox/RebaseLibrary">RebaseLibrary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bentobox/SushiStrategyV1">SushiStrategyV1</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/bentobox/interfaces/IBatchFlashBorrower">interfaces</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/bentobox/strategies/CompoundStrategy">strategies</a></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/deployments">Sushi Contracts Deployments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Sushiswap Incentives</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/kashi/getting-started">kashi</a></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/">üè†</a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/docs/onsen/">Onsen</a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link breadcrumbsItemLink_e5ie">masterchef</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/docs/onsen/masterchef/masterchef2">MasterChefV2</a></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>MasterChefV2</h1><h2 class="anchor anchorWithStickyNavbar_mojV" id="double-incentives">Double Incentives<a class="hash-link" href="#double-incentives" title="Direct link to heading">‚Äã</a></h2><p>The MasterChef contract gives out a constant number of SUSHI per Block. It is
the only address with minting rights for the SUSHI token. Therefore any
incentive mechanism must be based upon that contract. The idea for this
MasterChef V2 (MCV2) contract is therefore to be the owner of a dummy token that
is deposited into the MasterChef V1 (MCV1) contract. The allocation point for
this pool on MCV1 is the total allocation point for all pools that receive
double incentives.</p><hr><p>The MasterChef contract gives out a constant number of SUSHI per Block. It is
the only address with minting rights for the SUSHI token. Therefore any
incentive mechanism must be based upon that contract. The idea for this
MasterChef V2 (MCV2) contract is therefore to be the owner of a dummy token that
is deposited into the MasterChef V1 (MCV1) contract. The allocation point for
this pool on MCV1 is the total allocation point for all pools that receive
double incentives.</p><p>The distribution logic from MCV1 is taken over and simplified with the key
differentiator that the allocation of SUSHI for all pools is calculated through
the allocation towards the master pool on MCV1 instead of being a constant.</p><p>Reward Contracts are set at Pool Addition, all Logic is executed on those.</p><p>Instead of doing token transfers on deposit and withdrawal, instead, the
rewardDebt is changed accordingly. As it now is allowed to go negative, it is
changed to a signed integer. The appropriate version of SignedSafeMath is used
with an additional safe conversion to uint256.</p><p><code>UserInfo</code> should only be changed for <code>msg.sender</code></p><p><code>amount</code> How many LP tokens the user has provided, should be equal to
<code>lp.balanceOf(user)</code></p><p><code>rewardDebt</code> keeps track of how much the user is owed or has been credited
already</p><p><code>PoolInfo</code> keeps information on LP position</p><p><code>accSushiPerShare</code> Accumulated SUSHIs per share, times 1e12.</p><p><code>allocPoint</code> How many allocation points assigned to this pool</p><p><code>lastRewardBlock</code> Last block number that SUSHIs distribution occurs.</p><p><code>MasterChef</code> address of MasterChef contract
(<code>0xc2EdaD668740f1aA35E4D8f227fB8E17dcA888Cd</code>)</p><p><code>sushi</code> address of sushi contract (<code>0x6b3595068778dd592e39a122f4f5a5cf09c90fe2</code>)</p><p><code>MASTER_PID</code> pool id of dummy Token on MasterChef V1</p><p><code>totalAllocPoint</code> Total allocation points. Must be the sum of all allocation
points in all pools.</p><p>The following arrays should be accessed by the same index <code>pid</code></p><p><code>PoolInfo[] public poolInfo</code></p><p><code>IRewarder[] public rewarder</code></p><p>Pulls the balance of the dummyToken from <code>msg.sender</code> and deposit it in
MasterChef V1 in the dummy token pool.</p><p>Adds a reward pool for a specified LP Token with an allocation point and a
rewarder contract by adding to the <code>poolInfo</code> , <code>rewarder</code> und <code>lpToken</code> array.</p><p>Emits the Index of the newly added pool (<code>pid</code>) among the above parameter.</p><p>Updates the given pools identified by the array index <code>pid</code> with a new
allocation point and changes the rewarder contract if <code>overwrite</code> is true.</p><p>Update reward variables of the given pool to be up-to-date.</p><p><code>accSushiPerShare</code> is the accumulated amount of Sushi per share of this pool and
increased by the difference of <code>block.number</code> and <code>lastRewardBlock</code> times the
percentage the MasterChefV2 pool has in MCV1 and the percentage this pool has in
MCV2 times the constant emission of SUSHI per block (100) divided by the number
of LP tokens in this pool.</p><p>Calculates the amount of Sushi a given user can harvest from a given pool. The
amount of sushi for a user is the number of LP token a user has in this pool
(<code>user.amount</code>) times <code>accSushiPerShare</code> minus the <code>rewardDebt</code></p><p>A depositor deposits LP tokens into a given pool to a given user. <code>user.amount</code>
is increased according to the amount. The <code>rewardDebt</code> is increased by <code>amount</code>
added times <code>pool.accSushiPerShare</code> / <code>ACC_SUSHI_PRECISION</code> to ensure that the
user does not gain rewards from the past.</p><p>The rewarder contract is called with the new lp token amount of the user. Only
afterwards the lp tokens are transferred to the rewarder.</p><p>A user withdraws LP tokens from a given pool to a given address. <code>user.amount</code>
is decreased according to the amount. The <code>rewardDebt</code> is decreased by <code>amount</code>
added times <code>pool.accSushiPerShare</code> / <code>ACC_SUSHI_PRECISION</code> .</p><p>The rewarder contract is called with the new lp token amount of the user. Only
afterwards the lp tokens are transferred to the rewarder.</p><p>Allows a user to withdraw the pending amount of Sushi to a given address.</p><p>The pending amount is <code>user.amount</code> times <code>accSushiPerShare</code> /
<code>ACC_SUSHI_PRECISION</code> - <code>user.rewardDebt</code>.</p><p>The rewardDebt needs to be increased to mark the withdrawal to <code>user.amount</code>
times <code>accSushiPerShare</code> / <code>ACC_SUSHI_PRECISION</code>.</p><p>A call is executed to the <code>rewarder</code> with the function call of <code>onSushiReward</code>
defined by the interface below.</p><p>function sushiPerBlock() public view returns (uint256 amount) {</p><p>amount \= uint256(MASTERCHEF_SUSHI_PER_BLOCK)</p><p>.mul(masterChef.poolInfo(MASTER_PID).allocPoint) / masterChef.totalAllocPoint();</p><p>Projects that want to give out additional incentives can do so by creating a
contract that follows the interface below.</p><p>function onSushiReward(uint256 pid, address user, address recipient, uint256
sushiAmount, uint256 newLpAmount) external;</p><p>function pendingTokens(uint256 pid, address user, uint256 sushiAmount) external
view returns (IERC20<!-- -->[<!-- -->]<!-- --> memory, uint256<!-- -->[<!-- -->]<!-- --> memory);</p><p>The function onSushiReward is executed on the distribution of rewards with the
user and the amount of Sushi given out being specified. The responsibility of
implementing additional rewards now lies in the hands of the other project.</p><p>In Addition to the data currently provided to MasterChef on pool addition a
rewarder is added, the new interface for add is, therefore:</p><p>function add(uint256 allocPoint, IERC20 <!-- -->_<!-- -->lpToken, IRewarder <!-- -->_<!-- -->rewarder) public
onlyOwner;</p><p>Sushi has to be manually harvested from MCV1 to be able to withdrawn.</p><p>function harvestFromMasterChef () public {</p><p>masterChef.deposit(MASTER_PID, 0);</p><p>In the current draft, the exact pending amount has to be available for a
withdraw to succeed. This may cause issues because of rounding errors in case
there is only one user in the pool but also protects the user from withdrawing
without their allocated SUSHI.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="changes-of-total-allocation-in-mcv1-and-allocation-of-master-pool">Changes of Total Allocation in MCV1 and allocation of Master Pool<a class="hash-link" href="#changes-of-total-allocation-in-mcv1-and-allocation-of-master-pool" title="Direct link to heading">‚Äã</a></h2><p>If the total Allocation of MCV1 is changed or the allocation point of the master
pool, all pools on MCV2 have to be updated as well before the update on MCV1,
the Gnosis Safe should be used to update within the same transaction.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/manifoldfinance/sushi-doc-portal/edit/master/docs/onsen/masterchef/masterchef2.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-03-22T02:46:58.000Z">3/22/2022</time></b> by <b>sam bacha</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/onsen/masterchef/guide_doublerewards"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Double Rewards: A Developer&#x27;s Guide - Dev Hub</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/category/stratagies"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Stratagies</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#double-incentives" class="table-of-contents__link toc-highlight">Double Incentives</a></li><li><a href="#changes-of-total-allocation-in-mcv1-and-allocation-of-master-pool" class="table-of-contents__link toc-highlight">Changes of Total Allocation in MCV1 and allocation of Master Pool</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.540d009b.js"></script>
<script src="/assets/js/main.30cfd76f.js"></script>
</body>
</html>